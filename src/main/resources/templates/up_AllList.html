<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head>

	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<!-- CSS -->
	<link rel="stylesheet" href="css/bootstrap-reboot.min.css">
	<link rel="stylesheet" href="css/bootstrap-grid.min.css">
	<link rel="stylesheet" href="css/owl.carousel.min.css">
	<link rel="stylesheet" href="css/magnific-popup.css">
	<link rel="stylesheet" href="css/select2.min.css">
	<link rel="stylesheet" href="css/paymentfont.min.css">
	<link rel="stylesheet" href="css/slider-radio.css">
	<link rel="stylesheet" href="css/plyr.css">
	<link rel="stylesheet" href="css/main.css">

	<!-- Favicons -->
	<link rel="icon" type="image/png" href="icon/favicon-32x32.png" sizes="32x32">
	<link rel="apple-touch-icon" href="icon/favicon-32x32.png">

	<meta name="description" content="">
	<meta name="keywords" content="">
	<meta name="author" content="Dmitry Volkov">
	<title>Volna – Record label & Music streaming HTML Template</title>
</head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<body>
	<!-- header -->
	<header th:replace="header.html :: header"></header>
	<!-- end header -->
	<!-- sidebar -->
	<aside th:replace="sidebar.html :: aside"></aside>
	<!-- end sidebar -->
	
	<!-- main content -->
	<main class="main">
		<input th:if="${session.login ne null}" type="hidden"
			th:value="${session.login.mId}" th:id="mId">
		<div class="container-fluid">
			<div class="row row--grid">
				<!-- breadcrumb -->
				<div class="col-12">
					<ul class="breadcrumb">
						<li class="breadcrumb__item"><a href="/index">Home</a></li>
						<li class="breadcrumb__item breadcrumb__item--active">전체음악</li>
					</ul>
				</div>
				<!-- end breadcrumb -->

				<!-- title -->
				<div class="col-12">
					<div class="main__title main__title--page">
						<h1>전체음악</h1>
					</div>
				</div>
				<!-- end title -->
			</div>
			
			<div class="row row--grid">
				<div class="col-12">
					<div class="release">
						<div class="release__list" style="width: 120%; height: 600px;">
							<div class="scroll-content" id="allMuListArea"></div>
						</div>
					</div>
				</div>
			</div>
			<div id="pagingArea"></div>
		</div>
	</main>

	
	<div id="mplayArea"></div>
	

	<!-- end main content -->

	<!-- footer -->
	<footer th:replace="footer.html :: footer"></footer>
	<!-- end footer -->

	<!-- modal info -->
	<div id="modal-info2" class="zoom-anim-dialog mfp-hide modal modal--info">
		<span class="modal__icon modal__icon--green">
			<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.72,8.79l-4.29,4.3L8.78,11.44a1,1,0,1,0-1.41,1.41l2.35,2.36a1,1,0,0,0,.71.29,1,1,0,0,0,.7-.29l5-5a1,1,0,0,0,0-1.42A1,1,0,0,0,14.72,8.79ZM12,2A10,10,0,1,0,22,12,10,10,0,0,0,12,2Zm0,18a8,8,0,1,1,8-8A8,8,0,0,1,12,20Z"></path></svg>
		</span>
		
		<button class="modal__close" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13.41,12l4.3-4.29a1,1,0,1,0-1.42-1.42L12,10.59,7.71,6.29A1,1,0,0,0,6.29,7.71L10.59,12l-4.3,4.29a1,1,0,0,0,0,1.42,1,1,0,0,0,1.42,0L12,13.41l4.29,4.3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42Z"/></svg></button>

		<h4 class="sign__title">Payment #51 was successful!</h4>

		<div class="sign__group sign__group--row">
			<label class="sign__label">Total cost:</label>
			<span class="sign__value">$18.00</span>
		</div>

		<div class="sign__group sign__group--row">
			<label class="sign__label">Payment method: <b>Paypal</b></label>

			<span class="sign__text sign__text--small">There are many variations of passages of Lorem Ipsum available, but the majority have suffered alteration in some form, by injected humour, or randomised words which don't look even slightly believable.</span>
		</div>
	</div>
	<!-- end modal info -->

	<!-- modal info -->
	<div id="modal-info3" class="zoom-anim-dialog mfp-hide modal modal--info">
		<span class="modal__icon modal__icon--red">
			<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15.71,8.29a1,1,0,0,0-1.42,0L12,10.59,9.71,8.29A1,1,0,0,0,8.29,9.71L10.59,12l-2.3,2.29a1,1,0,0,0,0,1.42,1,1,0,0,0,1.42,0L12,13.41l2.29,2.3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42L13.41,12l2.3-2.29A1,1,0,0,0,15.71,8.29Zm3.36-3.36A10,10,0,1,0,4.93,19.07,10,10,0,1,0,19.07,4.93ZM17.66,17.66A8,8,0,1,1,20,12,7.95,7.95,0,0,1,17.66,17.66Z"></path></svg>
		</span>
		
		<button class="modal__close" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13.41,12l4.3-4.29a1,1,0,1,0-1.42-1.42L12,10.59,7.71,6.29A1,1,0,0,0,6.29,7.71L10.59,12l-4.3,4.29a1,1,0,0,0,0,1.42,1,1,0,0,0,1.42,0L12,13.41l4.29,4.3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42Z"/></svg></button>

		<h4 class="sign__title">Payment #50 failed!</h4>

		<div class="sign__group sign__group--row">
			<label class="sign__label">Total cost:</label>
			<span class="sign__value">$18.00</span>
		</div>

		<div class="sign__group sign__group--row">
			<label class="sign__label">Payment method: <b>Paypal</b></label>

			<span class="sign__text sign__text--small">There are many variations of passages of Lorem Ipsum available, but the majority have suffered alteration in some form, by injected humour, or randomised words which don't look even slightly believable.</span>
		</div>
	</div>
	<!-- end modal info -->

	<!-- modal info -->
	<div id="modal-info4" class="zoom-anim-dialog mfp-hide modal modal--info">
		<span class="modal__icon">
			<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,2A10,10,0,1,0,22,12,10.01114,10.01114,0,0,0,12,2Zm0,18a8,8,0,1,1,8-8A8.00917,8.00917,0,0,1,12,20Zm0-8.5a1,1,0,0,0-1,1v3a1,1,0,0,0,2,0v-3A1,1,0,0,0,12,11.5Zm0-4a1.25,1.25,0,1,0,1.25,1.25A1.25,1.25,0,0,0,12,7.5Z"></path></svg>
		</span>
		
		<button class="modal__close" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13.41,12l4.3-4.29a1,1,0,1,0-1.42-1.42L12,10.59,7.71,6.29A1,1,0,0,0,6.29,7.71L10.59,12l-4.3,4.29a1,1,0,0,0,0,1.42,1,1,0,0,0,1.42,0L12,13.41l4.29,4.3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42Z"/></svg></button>

		<h4 class="sign__title">Example of notification.</h4>

		<div class="sign__group sign__group--row">
			<label class="sign__label">Amount to auto-renew:</label>
			<span class="sign__value">$18.00</span>
		</div>

		<div class="sign__group sign__group--row">
			<span class="sign__text sign__text--small">There are many variations of passages of Lorem Ipsum available, but the majority have suffered alteration in some form, by injected humour, or randomised words which don't look even slightly believable.</span>
		</div>
	</div>
	<!-- end modal info -->

	<!-- modal info -->
	<div id="modal-info5" class="zoom-anim-dialog mfp-hide modal modal--info">
		<span class="modal__icon modal__icon--purple">
			<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18,7h-.35A3.45,3.45,0,0,0,18,5.5a3.49,3.49,0,0,0-6-2.44A3.49,3.49,0,0,0,6,5.5,3.45,3.45,0,0,0,6.35,7H6a3,3,0,0,0-3,3v2a1,1,0,0,0,1,1H5v6a3,3,0,0,0,3,3h8a3,3,0,0,0,3-3V13h1a1,1,0,0,0,1-1V10A3,3,0,0,0,18,7ZM11,20H8a1,1,0,0,1-1-1V13h4Zm0-9H5V10A1,1,0,0,1,6,9h5Zm0-4H9.5A1.5,1.5,0,1,1,11,5.5Zm2-1.5A1.5,1.5,0,1,1,14.5,7H13ZM17,19a1,1,0,0,1-1,1H13V13h4Zm2-8H13V9h5a1,1,0,0,1,1,1Z"></path></svg>
		</span>
		
		<button class="modal__close" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13.41,12l4.3-4.29a1,1,0,1,0-1.42-1.42L12,10.59,7.71,6.29A1,1,0,0,0,6.29,7.71L10.59,12l-4.3,4.29a1,1,0,0,0,0,1.42,1,1,0,0,0,1.42,0L12,13.41l4.29,4.3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42Z"/></svg></button>

		<h4 class="sign__title">You have received a gift!</h4>

		<div class="sign__group sign__group--row">
			<span class="sign__text sign__text--small">There are many variations of passages of Lorem Ipsum available, but the majority have suffered alteration in some form, by injected humour, or randomised words which don't look even slightly believable.</span>

			<span class="sign__text sign__text--small">There are many variations of passages of Lorem Ipsum available, but the majority have suffered alteration in some form, by injected humour, or randomised words which don't look even slightly believable.</span>
		</div>
	</div>
	<!-- end modal info -->


</body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js">
</script>
<script th:if="${session.login eq null}">
	alert('로그인 이후 이용해주세요');
	location.href="memberLogin";
</script>
<script type="text/javascript" src="https://service.iamport.kr/js/iamport.payment-1.1.5.js"></script>
<script type="text/javascript" th:inline="javascript">

	var CheckLogin = [[${session.login}]]
	
	if(CheckLogin != null){
		var sessionId = [[${session.login.mId}]]
	}
	
	$(document).ready(function(){
		
		$.ajax({
			type : "POST",
			url : "ajaxFileList",
			dataType : "json",
			success : function(list){
				allFileList(list);
				filePaging(list);
			},
			error : function(){
				alert('음악목록 실패');
			}
		});
		
		function filePaging(list){
			var output = "";
			
			var paging = list.paging;
            var musicList = list.musicList;

            console.log(paging);
            console.log(paging.maxPage);
            console.log(paging.endPage);

			if(paging.page <= 1){
				output += "<span>[이전] </span>"
			} else if(paging.page > 1){
				output += "<span id='"+paging.page+"' class='previousPage' value='"+paging.limit+"'><a href='#'>[이전] </a></span>";
			}
			
			for(var i=paging.startPage; i<=paging.endPage; i++){
				if(paging.page == i){
					output += "<span> ["+i+"] </span>";
				} else if(paging.page != i){
					output += "<span id='"+ i +"' class='selectPage' value='"+paging.limit+"'><a href='#'> "+ i +" </a></span>";
				}
			}
			
			if(paging.page >= paging.maxPage){
				output += "<span> [다음]</span>"
			} else if(paging.page < paging.maxPage){
				output += "<span id='"+paging.page+"' class='nextPage' value='"+paging.limit+"'><a href='#'> [다음]</a></span>";
			}
			
			var pagingArea = document.getElementById('pagingArea');
			
			pagingArea.innerHTML = output;
			
			$(".previousPage").click(function(){
				var page = $(this).attr('id');
				console.log("page : "+page);
				
				var limit = $(this).attr('value');
				console.log("limit : "+limit);
				
				var page1 = page - 1;
				console.log("page1 : " + page1);
				
				$.ajax({
					type : "POST",
					url : "ajaxFileList",
					data : {"page" : page1,
							"limit" : limit},
					dataType : "json",
					success : function(list){
						allFileList(list);
						filePaging(list);
					},
					error : function(){
						alert('음악목록 실패');
					}
				});
				
			});
			
			$(".selectPage").click(function(){
				var page = $(this).attr('id');
				console.log("page : "+page);
				
				var limit = $(this).attr('value');
				console.log("limit : "+limit);
				
				$.ajax({
					type : "POST",
					url : "ajaxFileList",
					data : {"page" : page,
							"limit" : limit},
					dataType : "json",
					success : function(list){
						allFileList(list);
						filePaging(list);
					},
					error : function(){
						alert('음악목록 실패');
					}
				});
				
			});
			
			$(".nextPage").click(function(){
				var page = $(this).attr('id');
				console.log("page : "+page);
				
				var limit = $(this).attr('value');
				console.log("limit : "+limit);
				
				var page2 = parseInt(page) + 1;
				
				console.log("page2 : " + page2);
				
				$.ajax({
					type : "POST",
					url : "ajaxFileList",
					data : {"page" : page2,
							"limit" : limit},
					dataType : "json",
					success : function(list){
						allFileList(list);
						filePaging(list);
					},
					error : function(){
						alert('음악목록 실패');
					}
				});
			});
			
		}
		
		function allFileList(list) {
			
			var paging = list.paging;
            var musicList = list.musicList;
            
            console.log("paging : " + paging +", musicList : " + musicList)

			var output = "";
            output += "<table id='buyListTable' class='main__table'>";
			output += "<thead>"
			output += "<tr>";
			output += "<th></th>"
			output += "<th>가수</th>";
			output += "<th>제목</th>";
			output += "<th>미리 듣기</th>";
			output += "<th>장르</th>";
			output += "<th>게시일</th>";
			output += "<th>조회수</th>";
			output += "<th>좋아요수</th>";
			output += "<th>구매여부</th>";
			output += "</tr>";
			output += "</thead>"
			
			for(var i in musicList){
				(function(i){
					$.ajax({
						type: "POST",
						url: "CartInCheck",
						data: {"caMuCode" : musicList[i].muCode,
							   "caMid" : sessionId},
						dataType: "json",
						async: false,
						success: function(result){

							$.ajax({
								type: "POST",
								url: "PayInCheck",
								data: {"pMuCode": musicList[i].muCode,
									   "psMid": sessionId},
								dataType: "json",
								async: false,
								success: function(check){
									output += "<tbody>"
									output += "<tr>";
									output += "<td class='main__table-text'><a href='muView?muCode="+musicList[i].muCode+"&mId="+sessionId+"' style='padding-top:10%;'><img class='single-item__cover' src='muImage/"+musicList[i].muImage+"' style='width:50px;'/></a></td>";
									output += "<td><div class='main__table-text'>"+musicList[i].muSinger+"</div></td>";
									output += "<td><div class='main__table-text'><a href='muView?muCode="+musicList[i].muCode+"&mId="+sessionId+"'>"+musicList[i].muName+"</a></div></td>";
									output += "<td><div class='main__table-text'><label><img src='icon/play.png' style='cursor:pointer; opacity:0.8;'><button style='display: none' name = "+i+" class='play' id='mplay' value='"+musicList[i].mFile+","+musicList[i].muName+","+musicList[i].muSinger+","+musicList[i].muCode+","+musicList[i].muImage+"'></button ></label></div></td>";
									output += "<td><div class='main__table-text'>"+musicList[i].muGanre+"</div></td>";
									output += "<td><div class='main__table-text'>"+musicList[i].muDate+"</div></td>";
									output += "<td><div class='main__table-text'>"+musicList[i].muHit+"</div></td>";
									output += "<td><div class='main__table-text'>"+musicList[i].muLike+"</div></td>";
									
									if(check == ""){
										if(result == ""){
											output += "<td style='padding-left:1%;'><a href='#' style='width:32px; height:32px;'>";
											output += "<img src='/img/cartCheck.png' style='width: 32px; opacity:0.4;' id='"+musicList[i].muCode+"' class='cartChange' value='check1'></a></td>";
										} else if(result != ""){
											output += "<td style='padding-left:1%;'><a href='#' style='width:32px; height:32px;'>";
											output += "<img src='/img/cartDelete.png' style='width: 32px; opacity:0.4;' id='"+musicList[i].muCode+"' class='cartChange' value='check2'></a></td>";
										}
									} else if(check != ""){
										output += "<td><a href='/audio/"+musicList[i].mFile+"' download='"+musicList[i].mFile+"' class='single-item__export'>";
										output += "<svg class='selectMusicDownload' id='"+musicList[i].muCode+"download' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'><path d='M21,14a1,1,0,0,0-1,1v4a1,1,0,0,1-1,1H5a1,1,0,0,1-1-1V15a1,1,0,0,0-2,0v4a3,3,0,0,0,3,3H19a3,3,0,0,0,3-3V15A1,1,0,0,0,21,14Zm-9.71,1.71a1,1,0,0,0,.33.21.94.94,0,0,0,.76,0,1,1,0,0,0,.33-.21l4-4a1,1,0,0,0-1.42-1.42L13,12.59V3a1,1,0,0,0-2,0v9.59l-2.29-2.3a1,1,0,1,0-1.42,1.42Z'/></svg></a></td>";
									}
									output += "</tr>";
									output += "</tbody>"
								},
								error: function(){
									console.log('실패');
								},
							});
							

						},
						error: function(){
							alert('장바구니에 담은 리스트 불러오기 실패');
						}
					});
				 })(i);
			}
			
			output += "</table>";
			
			var allMuListArea = document.getElementById('allMuListArea');
			allMuListArea.innerHTML = output;
			
			$(".cartChange").click(function(){
				
				var muCode = $(this).attr('id');
				console.log("muCode : "+muCode);
				
				var cartCheck = $(this).attr('value');
				
				if(cartCheck == "check1"){
					$.ajax({
						type : "POST",
						url : "cartListAdd",
						data : {"caMuCode" : muCode,
								"caMid" : sessionId
								},
						dataType : "json",
						success : function(list){
							CartAddSuccess(list);
							$.ajax({
								type : "POST",
								url : "ajaxCartList",
								data : {"caMid" : sessionId},
								dataType : "json",
								success : function(list){
									smallCart(list);
								},
								error : function(){
									console.log("장바구니 개수 출력 실패");
								}
							});
						},
						error : function(){
							alert('장바구니 추가 실패');
						}
					});
					
					function CartAddSuccess(list){
						
						var output = "";
						
						output += "<img src='/img/cartDelete.png' style='width: 32px;' id='"+list.muCode+"' class='cartChange' value='check2'></a>";
						
						var td22 = document.getElementById(muCode);
						console.log(td22);
						td22.innerHTML = output;
					}
					$(this).attr('src','/img/cartDelete.png');
					cartCheck = $(this).attr('value','check2');
					
				}else if(cartCheck == "check2"){
					$.ajax({
						type : "POST",
						url : "cartListDelete",
						data : {"caMuCode" : muCode,
								"caMid" : sessionId
								},
						dataType : "json",
						success : function(list){
							CartDeleteSuccess(list);
							$.ajax({
								type : "POST",
								url : "ajaxCartList",
								data : {"caMid" : sessionId},
								dataType : "json",
								success : function(list){
									smallCart(list);
								},
								error : function(){
									console.log("장바구니 개수 출력 실패");
								}
							});
						},
						error : function(){
							alert('장바구니 삭제 실패');
						}
					});
					
					function CartDeleteSuccess(list){
						
						var output = "";
						
						output += "<img src='/img/cartCheck.png' style='width: 32px;' id='"+list.muCode+"' class='cartChange' value='check1'></a>";
						
						var td22 = document.getElementById(muCode);
						console.log(td22);
						td22.innerHTML = output;
					}
					
					$(this).attr('src','/img/cartCheck.png');
					cartCheck = $(this).attr('value','check1');
				}
				
			});
			
			function smallCart(list){
				var cartCountArea = document.getElementById('cartCountArea');
				
				if(list.length <= 0){
					cartCountArea.innerHTML = "";
				} else{
					cartCountArea.innerHTML = list.length;
				}
				
				var output = "";
				
				if(list.length > 4){
					output += "<a href='/cartList' class='header__all'>Go to cart</a>";
					for(var i=0; i<4; i++){
						output += "<div class='header__product'>";
						output += "<img src='muImage/"+list[i].muImage+"' style='width: 50px; height: 50px; border-radius: 70%; overflow: hidden;'>";
						output += "<p><a href='muView?muCode="+list[i].muCode+"&mId="+list[i].muSinger+"'><span id='"+list[i].muCode+"' class='cartMusicName' value='"+list[i].muSinger+"' name='"+list[i].muName+"'>"+list[i].muName+"</span></a></p>";
						output += "<span>"+list[i].muSinger+"</span>";
						output += "<button id='"+list[i].muCode+"' class='cartDelete' type='button'><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'><path d='M13.41,12l6.3-6.29a1,1,0,1,0-1.42-1.42L12,10.59,5.71,4.29A1,1,0,0,0,4.29,5.71L10.59,12l-6.3,6.29a1,1,0,0,0,0,1.42,1,1,0,0,0,1.42,0L12,13.41l6.29,6.3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42Z'></path></svg></button></div>";
					}
				}else if(list.length == 0){
					output += "<div class='header__product' style='padding-left:33px; padding-right:33px;'>";
					output += "<span>장바구니가 비어있습니다.</span></div>"
				}else{
					output += "<a href='/cartList' class='header__all'>Go to cart</a>";
					for(var i in list){
						output += "<div class='header__product'>";
						output += "<img src='muImage/"+list[i].muImage+"' style='width: 50px; height: 50px; border-radius: 70%; overflow: hidden;'>";
						output += "<p><a href='muView?muCode="+list[i].muCode+"&mId="+list[i].muSinger+"'><span id='"+list[i].muCode+"' class='cartMusicName' value='"+list[i].muSinger+"' name='"+list[i].muName+"'>"+list[i].muName+"</span></a></p>";
						output += "<span>"+list[i].muSinger+"</span>";
						output += "<button id='"+list[i].muCode+"' class='cartDelete' type='button'><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'><path d='M13.41,12l6.3-6.29a1,1,0,1,0-1.42-1.42L12,10.59,5.71,4.29A1,1,0,0,0,4.29,5.71L10.59,12l-6.3,6.29a1,1,0,0,0,0,1.42,1,1,0,0,0,1.42,0L12,13.41l6.29,6.3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42Z'></path></svg></button></div>";
					}
				}
				
				
				var smallCartListArea = document.getElementById('smallCartListArea');
				smallCartListArea.innerHTML = output;
				
				$(".cartDelete").click(function(){
					
					var muCode = $(this).attr('id');
					console.log("muCode : "+muCode);
					
					$.ajax({
						type : "POST",
						url : "cartListDelete",
						data : {"caMuCode" : muCode,
								"caMid" : sessionId
								},
						dataType : "json",
						success : function(list){
							smallCart(list);
							$("#cartListArea").load(window.location.href + "#cartListArea");
							$("#myMusicListArea").load(window.location.href + "#myMusicListArea");
							
							$.ajax({
								type : "POST",
								url : "ajaxFileList",
								dataType : "json",
								success : function(list){
									allFileList(list);
									filePaging(list);
								},
								error : function(){
									alert('음악목록 실패');
								}
							});
						},
						error : function(){
							alert('장바구니 삭제 실패');
						}
					});
				});
			}
			
			$(".play").click(function(){
				
				  
				var aa = new Array();
				console.log(aa);
				
				var playlength = $(".play").length;
				console.log("1"+playlength);
				
				var idx = $(this).attr('name');
				console.log(idx);
				
				for(var i=0; i < playlength; i++){
					aa[i] = i;

					if(idx == aa[i]){
						var aaa = idx;
					}
				}
				console.log(aa);
				console.log(aaa);
				
				
				$(".player").remove();
				var head= document.getElementsByTagName('html')[0];
				var script= document.createElement('script');
				var script1= document.createElement('script');
				var script2= document.createElement('script');
				var script3= document.createElement('script');
				var script4= document.createElement('script');
				var script5= document.createElement('script');
			
				script.src= 'js/owl.carousel.min.js';
				head.appendChild(script);
				
				script1.src= 'js/jquery.magnific-popup.min.js';
				head.appendChild(script1);
				
				script2.src= 'js/select2.min.js"';
				head.appendChild(script2);
				
				script3.src= 'js/jquery.inputmask.min.js';
				head.appendChild(script3);
			
				script4.src= 'js/plyr.min.js';
				head.appendChild(script4);
				
				script5.src= 'js/main.js';
				head.appendChild(script5);
			
				var mContent = $(this).attr('value');
				var array = mContent.split(",");
			    var mFile = array[0];
			    var muName = array[1]; 
			    var muSinger = array[2]; 
			    var muCode = array[3]; 
			    var muImage = array[4];

		        $.ajax({
		            type: "POST",
		            url: "playList",
		            data: {
		                "plmuCode": muCode,
		                "plMid": sessionId
		            },
		            dataType: "json",
		            success: function (playListInsert) {

		            },
		            error: function () {
		                console.log("에러에러!!")
		            }
		        });
		
			    
				console.log(mFile);
				console.log(muName);
		
				 var output="<div class='player'>"
				output+="<div class='player__cover'>"
				output+="<img src='muImage/"+muImage+"' alt=''></div>";
				output+="<div class='player__content'>";
				output+="<span class='player__track'><b class='player__title'>"+muName+"</b>-<span class='player__artist'>"+muSinger+"</span></span>";
				output+="<audio src='/audio/"+mFile+"' id='audio' controls></audio></div></div>"
				output+="<button class='player__btn' type='button'><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'><path d='M21.65,2.24a1,1,0,0,0-.8-.23l-13,2A1,1,0,0,0,7,5V15.35A3.45,3.45,0,0,0,5.5,15,3.5,3.5,0,1,0,9,18.5V10.86L20,9.17v4.18A3.45,3.45,0,0,0,18.5,13,3.5,3.5,0,1,0,22,16.5V3A1,1,0,0,0,21.65,2.24ZM5.5,20A1.5,1.5,0,1,1,7,18.5,1.5,1.5,0,0,1,5.5,20Zm13-2A1.5,1.5,0,1,1,20,16.5,1.5,1.5,0,0,1,18.5,18ZM20,7.14,9,8.83v-3L20,4.17Z'/></svg> Player</button>";
				
				var mplayArea= document.getElementsByTagName('body')[0];
				mplayArea.insertAdjacentHTML("afterend", output);
		
				/* var mplayArea=document.getElementById('mplayArea');
				mplayArea.innerHTML=output;  */
				audio.play();
				//.plyr__control--prev
				$(document).on('click','.plyr__control--next', function(e){ //동적으로 생성이되서 이벤트를 사용하지 못하여 document 추가
					
					aaa++;
					
					var idx2 = parseInt(aaa);
				
					console.log(idx2);
					
					var playlist1 = $('.play')[idx2];
					console.log(playlist1);
					
					$(".player").remove();
					var head= document.getElementsByTagName('html')[0];
					var script= document.createElement('script');
					var script1= document.createElement('script');
					var script2= document.createElement('script');
					var script3= document.createElement('script');
					var script4= document.createElement('script');
					var script5= document.createElement('script');
				
					script.src= 'js/owl.carousel.min.js';
					head.appendChild(script);
					
					script1.src= 'js/jquery.magnific-popup.min.js';
					head.appendChild(script1);
					
					script2.src= 'js/select2.min.js"';
					head.appendChild(script2);
					
					script3.src= 'js/jquery.inputmask.min.js';
					head.appendChild(script3);
				
					script4.src= 'js/plyr.min.js';
					head.appendChild(script4);
					
					script5.src= 'js/main.js';
					head.appendChild(script5);
					
					var testtt = $(playlist1).attr('value');
					var array = testtt.split(",");
				    var mFile = array[0];
				    var muName = array[1]; 
				    var muSinger = array[2]; 
				    var muCode = array[3]; 
				    var muImage = array[4];
					

			        $.ajax({
			            type: "POST",
			            url: "playList",
			            data: {
			                "plmuCode": muCode,
			                "plMid": sessionId
			            },
			            dataType: "json",
			            success: function (playListInsert) {

			            },
			            error: function () {
			                console.log("에러에러!!")
			            }
			        });
			        
			
					var output1="<div class='player'>"
					output1+="<div class='player__cover'>"
					output1+="<img src='muImage/"+muImage+"' alt=''></div>";
					output1+="<div class='player__content'>";
					output1+="<span class='player__track'><b class='player__title'>"+muName+"</b>-<span class='player__artist'>"+muSinger+"</span></span>";
					output1+="<audio src='/audio/"+mFile+"' id='audio' controls></audio></div></div>"
					output1+="<button class='player__btn' type='button'><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'><path d='M21.65,2.24a1,1,0,0,0-.8-.23l-13,2A1,1,0,0,0,7,5V15.35A3.45,3.45,0,0,0,5.5,15,3.5,3.5,0,1,0,9,18.5V10.86L20,9.17v4.18A3.45,3.45,0,0,0,18.5,13,3.5,3.5,0,1,0,22,16.5V3A1,1,0,0,0,21.65,2.24ZM5.5,20A1.5,1.5,0,1,1,7,18.5,1.5,1.5,0,0,1,5.5,20Zm13-2A1.5,1.5,0,1,1,20,16.5,1.5,1.5,0,0,1,18.5,18ZM20,7.14,9,8.83v-3L20,4.17Z'/></svg> Player</button>";
					
					var mplayArea= document.getElementsByTagName('body')[0];
					mplayArea.insertAdjacentHTML("afterend", output1);
					audio.play();
			
				});
					$(document).on('click','.plyr__control--prev', function(e){ //동적으로 생성이되서 이벤트를 사용하지 못하여 document 추가
					
					aaa--;
					
					var idx2 = parseInt(aaa);
				
					console.log(idx2);
					
					var playlist1 = $('.play')[idx2];
					console.log(playlist1);
					
					$(".player").remove();
					var head= document.getElementsByTagName('html')[0];
					var script= document.createElement('script');
					var script1= document.createElement('script');
					var script2= document.createElement('script');
					var script3= document.createElement('script');
					var script4= document.createElement('script');
					var script5= document.createElement('script');
				
					script.src= 'js/owl.carousel.min.js';
					head.appendChild(script);
					
					script1.src= 'js/jquery.magnific-popup.min.js';
					head.appendChild(script1);
					
					script2.src= 'js/select2.min.js"';
					head.appendChild(script2);
					
					script3.src= 'js/jquery.inputmask.min.js';
					head.appendChild(script3);
				
					script4.src= 'js/plyr.min.js';
					head.appendChild(script4);
					
					script5.src= 'js/main.js';
					head.appendChild(script5);
					
					var testtt = $(playlist1).attr('value');
					var array = testtt.split(",");
				    var mFile = array[0];
				    var muName = array[1]; 
				    var muSinger = array[2]; 
				    var muCode = array[3]; 
				    var muImage = array[4];

			        $.ajax({
			            type: "POST",
			            url: "playList",
			            data: {
			                "plmuCode": muCode,
			                "plMid": sessionId
			            },
			            dataType: "json",
			            success: function (playListInsert) {

			            },
			            error: function () {
			                console.log("에러에러!!")
			            }
			        });
					
					
					var output1="<div class='player'>"
					output1+="<div class='player__cover'>"
					output1+="<img src='muImage/"+muImage+"' alt=''></div>";
					output1+="<div class='player__content'>";
					output1+="<span class='player__track'><b class='player__title'>"+muName+"</b>-<span class='player__artist'>"+muSinger+"</span></span>";
					output1+="<audio src='/audio/"+mFile+"' id='audio' controls></audio></div></div>"
					output1+="<button class='player__btn' type='button'><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'><path d='M21.65,2.24a1,1,0,0,0-.8-.23l-13,2A1,1,0,0,0,7,5V15.35A3.45,3.45,0,0,0,5.5,15,3.5,3.5,0,1,0,9,18.5V10.86L20,9.17v4.18A3.45,3.45,0,0,0,18.5,13,3.5,3.5,0,1,0,22,16.5V3A1,1,0,0,0,21.65,2.24ZM5.5,20A1.5,1.5,0,1,1,7,18.5,1.5,1.5,0,0,1,5.5,20Zm13-2A1.5,1.5,0,1,1,20,16.5,1.5,1.5,0,0,1,18.5,18ZM20,7.14,9,8.83v-3L20,4.17Z'/></svg> Player</button>";
					
					var mplayArea= document.getElementsByTagName('body')[0];
					mplayArea.insertAdjacentHTML("afterend", output1);
					audio.play();
				});
			});
			
			$(".selectMusicDownload").click(function(){
				
				var selectDownloadMusicCode = $(this).attr("id");
				console.log(selectDownloadMusicCode);
				console.log(sessionId);
				
				var selectMusicCode = selectDownloadMusicCode.replace("download","");
				console.log(selectMusicCode);
				
				$.ajax({
					type: "POST",
					url: "downloadTableInsert",
					data: {"mudMuCode": selectMusicCode,
						   "mudMid": sessionId},
					dataType: "json",
					success : function(list){
					},
					error : function(){
						console.log('다운로드 테이블 등록 실패');
					}
				});
				
			});
			
		}
		
	});
	
</script>
<!-- JS -->
	 <script src="js/jquery-3.5.1.min.js"></script>
	<script src="js/bootstrap.bundle.min.js"></script>
	<script src="js/owl.carousel.min.js"></script>
	<script src="js/jquery.magnific-popup.min.js"></script>
	<script src="js/smooth-scrollbar.js"></script>
	<script src="js/select2.min.js"></script>
	<script src="js/slider-radio.js"></script>
	<script src="js/jquery.inputmask.min.js"></script>
	<script src="js/plyr.min.js"></script>
	<script src="js/main.js"></script> 
</html>